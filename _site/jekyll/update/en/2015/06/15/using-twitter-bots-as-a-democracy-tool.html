<!DOCTYPE html> <html> <head> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1"> <title>Using Twitter-bots as a democracy tool</title> <meta name="description" content=""> <link rel="stylesheet" href="/css/main.css"> <link rel="stylesheet" href="/css/custom_css.css"> <link rel="canonical" href="http://karlheinzniebuhr.github.io/jekyll/update/en/2015/06/15/using-twitter-bots-as-a-democracy-tool.html"> <link rel="alternate" type="application/rss+xml" title="Karl's Blog" href="http://karlheinzniebuhr.github.io/feed.xml" /> <!-- favicon --> <link rel="shortcut icon" href="/images/favicon.ico"> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-37427094-3', 'auto'); ga('send', 'pageview'); </script> <!-- Selection-sharer --> <script src="http://code.jquery.com/jquery-latest.js"></script> <link rel="stylesheet" href="selection-sharer/dist/selection-sharer.css" /> <script src="selection-sharer/src/selection-sharer.js"></script> <script> var sharer = new SelectionSharer('p'); </script> </head> <body> <header class="site-header"> <div class="wrapper"> <a class="site-title" href="/">Karl's Blog</a> <nav class="site-nav"> <a href="#" class="menu-icon"> <svg viewBox="0 0 18 15"> <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/> <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/> <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/> </svg> </a> <div class="trigger"> <!-- <a class="page-link" href="/fitness/">Fitness</a> --> <a class="page-link" href="/ES/">ES</a> <a class="page-link" href="/about/">About</a> <!-- <a class="page-link" href="/ES/">Karl's Blog</a> --> </div> </nav> </div> </header> <div class="page-content"> <div class="wrapper"> <div class="post"> <header class="post-header"> <h1 class="post-title">Using Twitter-bots as a democracy tool</h1> <script src="/share-button/share-button.min.js"></script> <link href="/share-button/share-button.css" rel="stylesheet"> <share-button></share-button> <script> var shareButton = new ShareButton(); </script> <p class="post-meta">Jun 15, 2015</p> </header> <article class="post-content"> <h5>By Karlheinz Niebuhr, follow me on <a href="https://twitter.com/NiebuhrKarl">twitter</a>, and <a href="https://github.com/Karlheinzniebuhr">github</a></h5> <p><strong><em>Background information</em></strong>: On Thursday morning 04.06.15 the Paraguayan Senate defeated a mandatory data retention bill that would have compelled local ISPs to retain communications and location details of every user for a period of 12 months.<a href="#1">[1]</a></p> <h3 id="introduction">Introduction</h3> <p>A key tool which was used by Paraguayans to fight the data retention law is a python script named “Pyrawebs”. The name of the Tool which sends automated tweets to the Paraguayan politicians, alludes to the digital version of pyragües, informers who monitored the civilian population’s movements on behalf of dictator Alfredo Stroessner, who ruled between 1954 and 1989. In this post I will explain how this script works and how it was used. Hopefully someone else can give it a meaningful use.</p> <h3 id="how-it-works">How it works</h3> <p>The tools which is written in python by <a href="https://twitter.com/juanbaezr">Juan</a> and <a href="https://twitter.com/melizeche">Marce</a> uses the <a href="https://github.com/tweepy/tweepy">tweepy library</a> to communicate with the twitter API. It can be executed via the command line and takes as input the names of two text files. One of them a list of Twitter users and the other one is the file which contains a list of all the tweets you want to send. IMAGES It iterates over every tweet and sends them to every single user contained in the users text file.</p> <h3 id="evading-spam-patrol">Evading spam patrol</h3> <p>One of the issues we encountered was an error message after a number of consecutive tweets. <br /> <strong><em>“This request looks like it might be automated. To protect our users from spam and other malicious activity, we can’t complete this action right now. Please try again later.”</em></strong><br /> Apparently the twitter API wasn’t amused.<br /> Fortunately I could solve this by rising the inferior time limit of the random time function. The twitter API gets suspicious if there are several new tweets in a short time period (Twitter engineers if you are reading this, don’t update your code.) And that’s it, now you can deliver meaningful tweets 24/7.<br /> Cheers</p> <h4 id="ill-post-the-main-code-below-for-more-details-check-it-out-on-githubhttpsgithubcomkarlheinzniebuhrpyrawebs"><a href="https://github.com/Karlheinzniebuhr/pyrawebs">I’ll post the main code below, for more details check it out on Github</a></h4> <h4 id="pyrawebspy">pyrawebs.py</h4> <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c">#!/usr/bin/env python</span>
<span class="c"># -*- coding: utf-8 -*-</span>

<span class="kn">import</span> <span class="nn">tweepy</span><span class="o">,</span> <span class="nn">time</span><span class="o">,</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">randint</span>
<span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">sleep</span>

<span class="c">#from our keys module (keys.py), import the keys dictionary</span>
<span class="kn">from</span> <span class="nn">my_own_keys</span> <span class="kn">import</span> <span class="n">keys</span>

<span class="n">CONSUMER_KEY</span> <span class="o">=</span> <span class="n">keys</span><span class="p">[</span><span class="s">&#39;CONSUMER_KEY&#39;</span><span class="p">]</span>
<span class="n">CONSUMER_SECRET</span> <span class="o">=</span> <span class="n">keys</span><span class="p">[</span><span class="s">&#39;CONSUMER_SECRET&#39;</span><span class="p">]</span>
<span class="n">ACCESS_TOKEN</span> <span class="o">=</span> <span class="n">keys</span><span class="p">[</span><span class="s">&#39;ACCESS_TOKEN&#39;</span><span class="p">]</span>
<span class="n">ACCESS_TOKEN_SECRET</span> <span class="o">=</span> <span class="n">keys</span><span class="p">[</span><span class="s">&#39;ACCESS_TOKEN_SECRET&#39;</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">oauth_login</span><span class="p">(</span><span class="n">consumer_key</span><span class="p">,</span> <span class="n">consumer_secret</span><span class="p">,</span><span class="n">access_key</span><span class="p">,</span><span class="n">access_secret</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;Authenticate with twitter using OAuth&quot;&quot;&quot;</span>
  <span class="n">auth</span> <span class="o">=</span> <span class="n">tweepy</span><span class="o">.</span><span class="n">OAuthHandler</span><span class="p">(</span><span class="n">consumer_key</span><span class="p">,</span> <span class="n">consumer_secret</span><span class="p">)</span>
  <span class="n">auth</span><span class="o">.</span><span class="n">set_access_token</span><span class="p">(</span><span class="n">access_key</span><span class="p">,</span> <span class="n">access_secret</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">tweepy</span><span class="o">.</span><span class="n">API</span><span class="p">(</span><span class="n">auth</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&quot;__main__&quot;</span><span class="p">:</span>
  <span class="n">api</span> <span class="o">=</span> <span class="n">oauth_login</span><span class="p">(</span><span class="n">CONSUMER_KEY</span><span class="p">,</span> <span class="n">CONSUMER_SECRET</span><span class="p">,</span> <span class="n">ACCESS_TOKEN</span><span class="p">,</span> <span class="n">ACCESS_TOKEN_SECRET</span><span class="p">)</span>
  <span class="k">print</span> <span class="s">&quot;Authenticated as: </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">api</span><span class="o">.</span><span class="n">me</span><span class="p">()</span><span class="o">.</span><span class="n">screen_name</span>

  <span class="n">l_tweets</span>   <span class="o">=</span> <span class="p">[]</span>
  <span class="n">l_targets</span>  <span class="o">=</span> <span class="p">[]</span>

  <span class="n">arg_tweets</span>  <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
  <span class="n">arg_target</span>  <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

  <span class="n">f_tweets</span>   <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">arg_tweets</span><span class="p">,</span><span class="s">&#39;r&#39;</span><span class="p">)</span>
  <span class="n">f_targets</span>  <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">arg_target</span><span class="p">,</span><span class="s">&#39;r&#39;</span><span class="p">)</span>

  <span class="n">s_tweets</span>   <span class="o">=</span> <span class="n">f_tweets</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
  <span class="n">s_targets</span>  <span class="o">=</span> <span class="n">f_targets</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
  
  <span class="c"># create list of target twitter accounts</span>
  <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">s_targets</span><span class="p">:</span>
    <span class="n">l_targets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s">&#39;utf-8&#39;</span><span class="p">))</span>

  <span class="c"># create list of tweets</span>
  <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">s_tweets</span><span class="p">:</span>
    <span class="n">l_tweets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s">&#39;utf-8&#39;</span><span class="p">))</span>

  <span class="c"># create and send the tweets</span>
  <span class="k">for</span> <span class="n">tweet</span> <span class="ow">in</span> <span class="n">l_tweets</span><span class="p">:</span>
    <span class="n">actual_target</span> <span class="o">=</span> <span class="s">&#39;@&#39;</span>
    <span class="k">for</span> <span class="n">target</span> <span class="ow">in</span> <span class="n">l_targets</span><span class="p">:</span>
      <span class="n">tweet</span>   <span class="o">=</span> <span class="n">tweet</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">actual_target</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">target</span> <span class="o">!=</span> <span class="s">&#39;&#39;</span><span class="p">:</span>
        <span class="n">actual_target</span> <span class="o">=</span> <span class="n">target</span>
      <span class="k">print</span> <span class="n">tweet</span>
      
      <span class="k">try</span><span class="p">:</span>
        <span class="n">api</span><span class="o">.</span><span class="n">update_status</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="n">tweet</span><span class="p">)</span>
        <span class="n">wait</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span><span class="mi">120</span><span class="p">)</span>
        <span class="k">print</span> <span class="s">&#39;wait: &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">wait</span><span class="p">)</span><span class="o">+</span><span class="s">&#39; seconds&#39;</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">wait</span><span class="p">)</span>
      <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exception</span><span class="p">:</span>
        <span class="k">print</span> <span class="n">exception</span>
        <span class="k">print</span> <span class="s">&quot;Failed to tweet:&quot;</span><span class="p">,</span> <span class="n">tweet</span>
      </code></pre></figure> <h4 id="key-file-keypy">key file key.py</h4> <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c">#!/usr/bin/env python</span>
<span class="c">#keys.py</span>
<span class="c">#visit http://dev.twitter.com to create an application and get your keys</span>
<span class="n">keys</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
<span class="n">CONSUMER_KEY</span> <span class="o">=</span> <span class="s">&#39;vlXuFjAa$3FGsdWMpemVQ&#39;</span><span class="p">,</span>
<span class="n">CONSUMER_SECRET</span> <span class="o">=</span> <span class="s">&#39;L1IKV1DUKKWs4gsdG3x2OUHt6Bby6uJLyhtgX7OUrNigwwb&#39;</span><span class="p">,</span>
<span class="n">ACCESS_TOKEN</span> <span class="o">=</span> <span class="s">&#39;e74DNGbuIwUd1xNOPDCXpMr3XYSCXpMr3XYPCCCSwIzZ&#39;</span><span class="p">,</span>
<span class="n">ACCESS_TOKEN_SECRET</span> <span class="o">=</span> <span class="s">&#39;8d8O2ZjuoTIUGXjbHCoJqpYxd13KtqxYhrX&#39;</span>
<span class="p">)</span>
<span class="c"># Don&#39;t even think of it, those are fake</span></code></pre></figure> <h4 id="list-of-target-twitter-accounts-insert-as-many-as-you-like">list of target twitter accounts.. insert as many as you like</h4> <figure class="highlight"><pre><code class="language-bash" data-lang="bash">@target1
@target2
@target3
@target4
@target5
@target6
@target7</code></pre></figure> <h4 id="list-of-tweets-you-can-insert-as-many-as-you-like">list of tweets.. you can insert as many as you like</h4> <figure class="highlight"><pre><code class="language-bash" data-lang="bash">@ Inconstitucional, desproporcionado, innecesario: ¡Diga no a <span class="c">#pyrawebs! eff.org/r.q0e5</span>
@ basta ya del espionaje, no a los <span class="c">#pyrawebs</span>
@ usted va a pagar de su propio bolsillo el aumento del costo del internet? <span class="c">#pyrawebs</span></code></pre></figure> <h1 id="check-out-the-code-and-tutorial-on-githubhttpsgithubcomkarlheinzniebuhrpyrawebs"><a href="https://github.com/Karlheinzniebuhr/pyrawebs">Check out the code and tutorial on Github</a></h1> <p>Resources: <br /> <a name="1" href="https://www.eff.org/deeplinks/2015/06/turning-tide-against-online-spying-paraguay">[1] https://www.eff.org/deeplinks/2015/06/turning-tide-against-online-spying-paraguay</a> <br /></p> </article> <p class="rss-subscribe">Subscribe <a href="/feed.xml">via RSS</a> or <a href="http://eepurl.com/by15bT">via E-mail</a></p> </div> <!-- Add Disqus comments. --> <div id="disqus_thread"></div> <script type="text/javascript"> /* * * CONFIGURATION VARIABLES * * */ var disqus_shortname = 'karlsjekyllblog'; /* * * DON'T EDIT BELOW THIS LINE * * */ (function() { var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true; dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js'; (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq); })(); </script> <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript> </div> </div> <footer class="site-footer"> <div class="wrapper"> <!-- <h2 class="footer-heading">Karl's Blog</h2> --> <div class="footer-col-wrapper"> <div class="footer-col footer-col-2" style="width:180px;"> <ul class="social-media-list"> <li> <a href="https://github.com/Karlheinzniebuhr"> <span class="icon icon--github"> <svg viewBox="0 0 16 16"> <path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/> </svg> </span> <span class="username">Github</span> </a> </li> </ul> </div> <div class="footer-col footer-col-2"> <ul class="social-media-list"> <li> <a href="https://twitter.com/NiebuhrKarl"> <span class="icon icon--twitter"> <svg viewBox="0 0 16 16"> <path fill="#828282" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809 c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/> </svg> </span> <span class="username">Twitter</span> </a> </li> </ul> </div> <div class="footer-col footer-col-2"> <ul class="social-media-list"> <li> <a href="https://facebook.com/Karlheinzniebuhr"> <span class="icon"> <svg width="15" height="15" version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 167.657 167.657" style="enable-background:new 0 0 167.657 167.657;" xml:space="preserve"> <path style="fill: #828282;" d="M83.829,0.349C37.532,0.349,0,37.881,0,84.178c0,41.523,30.222,75.911,69.848,82.57v-65.081H49.626 v-23.42h20.222V60.978c0-20.037,12.238-30.956,30.115-30.956c8.562,0,15.92,0.638,18.056,0.919v20.944l-12.399,0.006 c-9.72,0-11.594,4.618-11.594,11.397v14.947h23.193l-3.025,23.42H94.026v65.653c41.476-5.048,73.631-40.312,73.631-83.154 C167.657,37.881,130.125,0.349,83.829,0.349z"/> </svg> </span> <span class="username">Facebook</span> </a> </li> </ul> </div> <div class="footer-col footer-col-3"> <p class="text">A place where I share my stuff </p> </div> </div> </div> </footer> </body> </html>
